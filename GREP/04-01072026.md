# 04-01072026
Here’s **`grep` context line control** — how you control **how many lines appear *around* a match, how they’re labeled, and how groups behave**.

---

## 1. Basic context flags

### After context
```bash
grep -A 5 "ERROR" app.log
```
→ show **5 lines after** each match

---

### Before context
```bash
grep -B 5 "ERROR" app.log
```
→ show **5 lines before** each match

---

### Both (surrounding context)
```bash
grep -C 5 "ERROR" app.log
```
→ show **5 lines before AND after**

---

## 2. Context line prefixes

When context is enabled, `grep` prefixes lines:

```
:  matched line
-  context line (before/after)
```

Example:
```
42- initializing service
43- loading config
44: ERROR failed to bind port
45- retrying
46- aborting
```

---

## 3. Context group separators

By default, separate match groups with:
```
--
```

Example:
```
...
45- aborting
--
120- initializing service
121: ERROR out of memory
122- shutting down
```

---

### Disable group separators
```bash
grep -C 3 "ERROR" app.log --no-group-separator
```

---

## 4. Control overlapping context

### Merge overlapping context blocks (default)
If matches are close, `grep` merges them into **one block**.

---

### Force separate blocks (not supported)
`grep` **cannot** force separation — use `awk` if needed.

---

## 5. Multiple matches in context

Each matching line still gets `:`:

```
42: ERROR failed
43: ERROR retry failed
```

Context lines stay `-`.

---

## 6. Limit total matches with context

```bash
grep -m 1 -C 5 "ERROR" app.log
```

Stops after first match **and its context**.

---

## 7. Combine context with line numbers

```bash
grep -n -C 2 "ERROR" app.log
```

Output:
```
40- initializing
41- loading
42: ERROR failed
43- retrying
```

---

## 8. Recursive context searches

```bash
grep -r -n -C 2 "panic" .
```

Shows context **per file**, with separators.

---

## 9. Context with stdin / pipes

```bash
journalctl | grep -C 5 "segfault"
```

Use labeling if needed:
```bash
journalctl | grep --label=journal -C 5 "segfault"
```

---

## 10. Remove context markers (post-process)

Strip `:` and `-`:
```bash
grep -C 2 "ERROR" app.log | sed 's/^[0-9]\+[-:]//'
```

---

## 11. Practical log-hunting patterns

### Error with startup context
```bash
grep -n -B 10 "ERROR" app.log
```

---

### Crash with aftermath
```bash
grep -n -A 20 "segmentation fault" app.log
```

---

### Full incident window
```bash
grep -n -C 25 "CRITICAL" app.log
```

---

## Mental model
```
Before context  → -B N
After context   → -A N
Both sides      → -C N
Match line tag  → :
Context tag     → -
Separator       → --
```

---

If you want next:
- **context + color tuning**
- **context extraction for scripts**
- **awk-based advanced context slicing**
- **ripgrep context differences**

Just say the word.